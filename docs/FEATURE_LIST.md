# 全機能一覧

## ユーザータイプ別の機能分類

### 1. 全ユーザー共通機能

#### 1.1 ダッシュボード
- **機能**: 財務状況の概要表示
- **URL**: `/`
- **対象**: 全ユーザー
- **説明**: 選択中のCompanyの財務状況を一覧表示

#### 1.2 AI相談
- **機能**: AIによる財務・税務・補助金等の相談
- **URL**: `/ai-consultation/`
- **対象**: 全ユーザー
- **説明**: 
  - 相談タイプ別（財務相談、補助金・助成金、税務相談、法律相談、DX、予算策定）
  - よくある質問（FAQ）
  - 相談履歴
  - マイスクリプト（Company単位）

#### 1.3 月次PL管理
- **機能**: 月次損益計算書の管理
- **URL**: `/fiscal_summary_month/`
- **対象**: 全ユーザー
- **説明**:
  - 月次PL一覧（3期比較、直近年度）
  - 月次PL作成・編集・削除
  - 月次予算vs実績推移表
  - CSV取り込み（MoneyForward含む）

#### 1.4 年次財務諸表管理
- **機能**: 年次決算情報の管理
- **URL**: `/fiscal_summary_year/`
- **対象**: 全ユーザー
- **説明**:
  - 決算年次推移
  - 直近決算詳細
  - 年次予算vs実績比較
  - CSV取り込み（MoneyForward含む）

#### 1.5 予算管理
- **機能**: 予算の作成・管理・比較
- **URL**: `/budget/`
- **対象**: 全ユーザー
- **説明**:
  - AI予算策定（年次・月次）
  - 予算vs実績比較（年次・月次）
  - 予算分析

#### 1.6 借入管理
- **機能**: 借入金情報の管理
- **URL**: `/debts_all/`
- **対象**: 全ユーザー
- **説明**:
  - 借入一覧
  - 金融機関別表示
  - 保証別表示
  - アーカイブ済み
  - 新規借入登録

#### 1.7 株主情報管理
- **機能**: 株主・株式発行情報の管理
- **URL**: `/stakeholder_name/`, `/stock_event/`
- **対象**: 全ユーザー
- **説明**:
  - 株主名一覧
  - 株式発行一覧

#### 1.8 ノート（議事録）
- **機能**: 会議議事録の管理
- **URL**: `/meeting_minutes/`
- **対象**: 全ユーザー
- **説明**:
  - ノート一覧
  - 新規ノート作成
  - AI議事録生成（Firmユーザーのみ、Starter以上）

#### 1.9 ローカルベンチマーク
- **機能**: 業界別ベンチマークの参照
- **URL**: `/industry_benchmark_list/`
- **対象**: 全ユーザー
- **説明**: 業界別ベンチマーク一覧

#### 1.10 データ取り込み
- **機能**: 外部データの取り込み
- **URL**: `/import_*`, `/import_fiscal_summary_ocr/`
- **対象**: 全ユーザー
- **説明**:
  - CSV取り込み（月次PL、年次決算）
  - MoneyForward CSV取り込み
  - OCR読み込み（決算書、借入契約書）

#### 1.11 クラウドストレージ連携
- **機能**: Google Drive/Box連携
- **URL**: `/storage/`
- **対象**: 全ユーザー
- **説明**:
  - クラウドストレージ設定
  - OAuth認証
  - ストレージファイル一覧・処理

#### 1.12 ユーザープロフィール
- **機能**: ユーザー情報の管理
- **URL**: `/user_profile/`
- **対象**: 全ユーザー
- **説明**: プロフィール情報の編集

---

### 2. Company User専用機能（is_company_user=True）

#### 2.1 会社設定
- **機能**: 会社情報の管理
- **URL**: `/company/<id>/`
- **対象**: Company User（is_manager=Trueの場合のみ編集可能）
- **説明**:
  - 会社詳細表示・編集
  - 会社メンバー管理
  - マイスクリプト管理

---

### 3. Firm User専用機能（is_financial_consultant=True）

#### 3.1 クライアント管理
- **機能**: クライアント（Company）の管理
- **URL**: `/firm_clientslist/`
- **対象**: Firm Owner
- **説明**:
  - クライアント一覧
  - クライアント追加・削除
  - クライアント制限設定

#### 3.2 アサイン管理
- **機能**: アサインされたクライアントの管理
- **URL**: `/assigned-clients/`
- **対象**: 全Firm User
- **説明**: アサインされたクライアント一覧

#### 3.3 スタッフ管理
- **機能**: Firmメンバーの管理
- **URL**: `/firm/<firm_id>/members/`
- **対象**: Firm Owner
- **説明**:
  - スタッフ一覧
  - スタッフ招待
  - スタッフ権限管理

#### 3.4 プラン・サブスクリプション管理
- **機能**: プラン・サブスクリプションの管理
- **URL**: `/plans/<firm_id>/`
- **対象**: Firm Owner
- **説明**:
  - プラン一覧・詳細
  - サブスクリプション管理
  - プラン変更
  - Stripe決済連携

#### 3.5 利用状況レポート
- **機能**: 利用状況の確認
- **URL**: `/firm/<firm_id>/usage/report/`
- **対象**: Firm Owner
- **説明**:
  - 利用状況レポート（グラフ表示）
  - Company別利用状況
  - エクスポート（CSV/Excel/PDF）

#### 3.6 請求管理
- **機能**: 請求履歴・支払い方法の管理
- **URL**: `/firm/<firm_id>/billing/`
- **対象**: Firm Owner
- **説明**:
  - 請求履歴
  - 請求書詳細
  - 支払い方法更新

#### 3.7 サブスクリプション履歴
- **機能**: プラン変更履歴の確認
- **URL**: `/firm/<firm_id>/subscription/history/`
- **対象**: Firm Owner
- **説明**: プラン変更履歴

#### 3.8 Firm設定
- **機能**: Firm情報の管理
- **URL**: `/firm/<firm_id>/settings/`
- **対象**: Firm Owner
- **説明**: Firm名、APIキー等の設定

#### 3.9 通知機能
- **機能**: 通知の確認
- **URL**: `/firm/<firm_id>/notifications/`
- **対象**: Firm Owner
- **説明**: 通知一覧・詳細

---

### 4. 管理者専用機能（is_superuser=True）

#### 4.1 AIスクリプト管理
- **機能**: システム全体のAIスクリプト管理
- **URL**: `/admin/ai-scripts/`
- **対象**: Superuser
- **説明**: システム用AIスクリプトの作成・編集・削除

#### 4.2 Django管理画面
- **機能**: Django管理画面へのアクセス
- **URL**: `/admin/`
- **対象**: Superuser
- **説明**: 全データの管理

---

## 機能の優先度分類

### 高頻度使用機能（毎日使用）
1. ダッシュボード
2. 月次PL管理
3. 年次財務諸表管理
4. 借入管理
5. AI相談

### 中頻度使用機能（週1回程度）
1. 予算管理
2. ノート（議事録）
3. データ取り込み
4. 株主情報管理

### 低頻度使用機能（月1回程度）
1. 会社設定
2. クラウドストレージ連携
3. ローカルベンチマーク
4. Firm管理機能（Firm Userのみ）

---

## 機能の依存関係

### 前提となる機能
- **会社選択**: ほとんどの機能は選択中のCompanyに依存
- **データ取り込み**: 月次PL・年次財務諸表の前提
- **予算管理**: 年次財務諸表の実績データが必要

### 連携機能
- **AI相談 ↔ マイスクリプト**: カスタムスクリプトを使用
- **クラウドストレージ ↔ OCR**: ストレージからOCR処理
- **予算管理 ↔ 借入管理**: Debts情報を予算に反映

