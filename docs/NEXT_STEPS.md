# 次に実施すべきタスク一覧

## 📅 作成日: 2026-01-01

## 🎯 優先度別タスク

### 🔴 高優先度（即座に実施すべき）

#### 1. テストコードの拡充
**現状**: 基本的なテストのみ存在
**推奨アクション**:
- [ ] 統合テストの追加（CSVインポート、OCR、AI相談、クラウドストレージ）
- [ ] APIテストの追加（`AIConsultationAPIView`、ストレージ接続テスト）
- [ ] フォームバリデーションテスト
- [ ] Firm/Company関連のビジネスロジックテスト

**理由**: 
- 機能が増えるにつれて、回帰テストの重要性が増す
- 本番環境での予期しないエラーを防ぐ
- リファクタリング時の安全性を確保

**推定工数**: 2-3週間

---

#### 2. データベースインデックスの最適化
**現状**: 頻繁に検索されるフィールドにインデックスが不足している可能性
**推奨アクション**:
- [ ] パフォーマンステストの実施（`django-debug-toolbar`を使用）
- [ ] 遅いクエリの特定
- [ ] インデックスの追加（`Debt`, `FiscalSummary_Year/Month`, `AIConsultationHistory`, `UploadedDocument`など）
- [ ] 複合インデックスの検討

**理由**:
- データ量が増えるとクエリが遅くなる
- ユーザー体験に直接影響
- 本番環境でのパフォーマンス問題を予防

**推定工数**: 1週間

---

#### 3. レポートエクスポート機能の実装
**現状**: 利用状況レポートの表示は実装済み、エクスポート機能は未実装
**推奨アクション**:
- [ ] CSVエクスポート機能（利用状況レポート）
- [ ] Excelエクスポート機能（`openpyxl`使用）
- [ ] PDFレポート生成（`reportlab`または`weasyprint`使用）

**理由**:
- ユーザー要望が高い機能
- データ分析・共有に必要
- 競合他社との差別化

**推定工数**: 1-2週間

---

### 🟡 中優先度（中期で実施）

#### 4. クラウドストレージ連携の拡張
**現状**: Google Driveのみ実装済み
**推奨アクション**:
- [ ] Box連携の実装
- [ ] Dropbox連携の実装
- [ ] OneDrive連携の実装

**理由**:
- ユーザーの多様なニーズに対応
- 市場シェアの高いサービスに対応
- 競合優位性の確保

**推定工数**: 各1-2週間（合計3-6週間）

---

#### 5. freee連携の実装
**現状**: Money Forward CSVインポートのみ実装済み
**推奨アクション**:
- [ ] freee OAuth認証の実装
- [ ] freee APIクライアントの作成
- [ ] 決算書データの自動取得
- [ ] 月次データの自動取得

**理由**:
- ユーザー要望が多い
- 自動化によりユーザー体験が向上
- データ入力の手間を削減

**推定工数**: 2-3週間

---

#### 6. キャッシング戦略の実装
**現状**: キャッシュが使用されていない
**推奨アクション**:
- [ ] Redisキャッシュの導入（本番環境）
- [ ] キャッシュキーの設計
- [ ] キャッシュ無効化戦略の実装
- [ ] キャッシュ対象の特定（業界ベンチマーク、AI相談スクリプトなど）

**理由**:
- パフォーマンスの向上
- データベース負荷の軽減
- スケーラビリティの向上

**推定工数**: 1-2週間

---

#### 7. エラーハンドリングの改善
**現状**: `ErrorHandlingMixin`は実装済みだが、一部のビューで改善の余地あり
**推奨アクション**:
- [ ] すべてのビューで`ErrorHandlingMixin`の使用を確認
- [ ] 具体的な例外処理の追加
- [ ] ユーザーフレンドリーなエラーメッセージの統一
- [ ] エラーログの構造化（Sentry等の導入を検討）

**理由**:
- ユーザー体験の向上
- デバッグの容易化
- 本番環境での問題追跡

**推定工数**: 1週間

---

### 🟢 低優先度（長期で実施）

#### 8. その他の契約書OCR
**現状**: 決算書と借入契約書のみ対応
**推奨アクション**:
- [ ] リース契約書OCR
- [ ] 商品売買契約OCR
- [ ] 賃貸借契約OCR

**推定工数**: 各1週間

---

#### 9. メール通知機能
**現状**: 通知はシステム内のみ
**推奨アクション**:
- [ ] Djangoメール機能の設定
- [ ] 通知テンプレートの作成
- [ ] 通知設定の管理機能

**推定工数**: 1週間

---

#### 10. データバックアップ・復元機能
**推奨アクション**:
- [ ] 定期バックアップの自動実行
- [ ] バックアップファイルのダウンロード
- [ ] 復元機能

**推定工数**: 1-2週間

---

## 📊 推奨実装順序

### Phase 1: 品質向上（1-2ヶ月）
1. **テストコードの拡充** 🔴
2. **データベースインデックスの最適化** 🔴
3. **エラーハンドリングの改善** 🟡

### Phase 2: 機能拡張（2-3ヶ月）
4. **レポートエクスポート機能** 🔴
5. **freee連携** 🟡
6. **クラウドストレージ連携の拡張** 🟡（Box, Dropbox, OneDrive）

### Phase 3: パフォーマンス最適化（1-2ヶ月）
7. **キャッシング戦略の実装** 🟡

### Phase 4: その他の機能（随時）
8. **その他の契約書OCR** 🟢
9. **メール通知機能** 🟢
10. **データバックアップ・復元機能** 🟢

---

## 🎯 短期目標（3ヶ月以内）

1. ✅ テストコードの拡充（カバレッジ80%以上を目標）
2. ✅ データベースインデックスの最適化
3. ✅ レポートエクスポート機能（CSV/Excel）
4. ✅ freee連携の実装

---

## 📝 実装時の注意事項

### セキュリティ
- OAuthトークンの暗号化保存
- APIキーの適切な管理
- データアクセス制御の強化

### パフォーマンス
- 大量データ処理時の最適化
- 非同期処理の検討（Celery等）
- キャッシュ戦略の適切な設計

### ユーザビリティ
- エラーメッセージの改善
- ローディング状態の表示
- レスポンシブデザインの維持

### 保守性
- コードの可読性とメンテナンス性
- ドキュメントの整備
- テストコードの充実

---

## 🔗 関連ドキュメント

- [実装予定機能一覧](./FUTURE_FEATURES.md)
- [Firmユーザー向け機能一覧](./features/FIRM_USER_FEATURES.md)
- [実装状況サマリー](./IMPLEMENTATION_STATUS.md)
- [コードレビューサマリー](./CODE_REVIEW_SUMMARY.md)

---

## 📅 更新履歴

- 2026-01-01: 初版作成

